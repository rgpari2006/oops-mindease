<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindEase - Mental Health Wellness App</title>
    
    <!-- Link Core/Global Styles FIRST (Assuming global.css exists as per original) -->
    <link rel="stylesheet" href="global.css">
    
    <!-- Link App-Specific Styles SECOND -->
    <link rel="stylesheet" href="style.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Tone.js for ambient sounds (added crossorigin for better error reporting) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js" crossorigin="anonymous"></script>
</head>
<link rel="stylesheet"  href="style.css">
<style>
        /* limits logo height, keeps aspect ratio */
        .nav-logo img,
        .nav-logo .nav-logo-img {
            /* Updated for round shape */
            height: 50px; /* Set explicit height */
            width: 50px;  /* Set equal width for a circle */
            object-fit: cover; /* Ensures image fills the circle */
            border-radius: 50%; /* This makes it round */
            display: block;
            max-height: 60px; /* Kept max-height as a fallback */
        }

        /* --- REMOVED Logout Modal Styles --- */
        
    </style>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <!-- UPDATED: Changed src from logo.png to mindease_logo.png -->
                <img src="MindEaseLogo.jpg" alt="MindEase">
                
            </div>
            <div class="nav-menu">
                <a href="#" class="nav-link active" data-section="dashboard">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-link" data-section="meditation">
                    <i class="fas fa-leaf"></i>
                    <span>Meditation</span>
                </a>
                <a href="#" class="nav-link" data-section="mood">
                    <i class="fas fa-chart-line"></i>
                    <span>Mood Tracker</span>
                </a>
                <a href="#" class="nav-link" data-section="resources">
                    <i class="fas fa-book"></i>
                    <span>Resources</span>
                </a>
                <a href="#" class="nav-link" data-section="crisis">
                    <i class="fas fa-phone"></i>
                    <span>Crisis Support</span>
                </a>
                <a href="#" class="nav-link" data-section="chat">
                    <i class="fas fa-comments"></i>
                    <span>Chat Support</span>
                </a>
                <!-- Logout Button - MODIFIED to call handleDirectLogout() -->
              

                <a class="logout" href="index.html">Logout</a>
            </div>
            <style>
                .logout{
                    background-color:red;
                    color:white;
                    text-decoration:none;
                    padding:10px;
                    margin-left: 10px;
                    border-radius:10px;
                }
            </style>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <div class="container">
                <div class="welcome-card">
                    <h1>Welcome to MindEase</h1>
                    <p>Your personal mental health companion. Take a moment to check in with yourself.</p>
                    <div class="quick-actions">
                        <button class="btn btn-primary" data-action="meditation">
                            <i class="fas fa-leaf"></i>
                            Start Meditation
                        </button>
                        <button class="btn btn-secondary" data-action="mood">
                            <i class="fas fa-heart"></i>
                            Track Mood
                        </button>
                        <button class="btn btn-accent" data-action="chat">
                            <i class="fas fa-comments"></i>
                            Chat Support
                        </button>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <!-- REMOVED: Mood This Week Card (As per original) -->

                    <div class="card meditation-stats">
                        <h3>Meditation Progress</h3>
                        <div class="stat">
                            <span class="stat-number" id="totalSessions">0</span>
                            <span class="stat-label">Sessions Completed</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="totalMinutes">0</span>
                            <span class="stat-label">Minutes Practiced</span>
                        </div>
                    </div>

                    <!-- Meditation History -->
                    <div class="card meditation-history">
                        <h3>Recent Meditations</h3>
                        <div class="history-list" id="meditationHistoryList">
                            <!-- This will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="card daily-tip">
                        <h3>Daily Wellness Tip</h3>
                        <p id="dailyTip">Take three deep breaths and remind yourself that you are doing your best today.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Meditation Section -->
        <section id="meditation" class="section">
            <div class="container">
                <h2>Guided Meditation</h2>
                <div class="meditation-grid">
                    <div class="meditation-card">
                        <div class="meditation-player">
                            <div class="player-circle" id="meditationCircle">
                                <button class="play-btn" id="playPauseBtn">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                            <div class="meditation-info">
                                <h3 id="meditationTitle">Mindful Breathing</h3>
                                <p id="meditationDescription">Focus on your breath and find inner calm</p>
                                <div class="timer-display" id="timerDisplay">05:00</div>
                                <div class="volume-control" id="soundOptions" style="margin-top: 20px;">
                                    <h4>Volume</h4>
                                    <input type="range" id="soundVolume" min="0" max="100" value="50" style="width: 100%;">
                                </div>
                            </div>
                        </div>

                        <div class="meditation-controls">
                            <!-- 1. Time Selector -->
                            <div class="time-selector">
                                <button class="time-btn active" data-time="5">5 min</button>
                                <button class="time-btn" data-time="10">10 min</button>
                                <button class="time-btn" data-time="15">15 min</button>
                                <button class="time-btn" data-time="20">20 min</button>
                            </div>

                            <!-- 2. NEW: Mood Selector (Added as requested) -->
                            <div class="mood-selector-group" style="margin-top: var(--space-6);">
                                <h4>How are you feeling now?</h4>
                                <div class="time-selector" id="meditationMoodSelector">
                                    <button class="time-btn active" data-mood="calm">Calm</button>
                                    <button class="time-btn" data-mood="anxious">Anxious</button>
                                    <button class="time-btn" data-mood="tired">Tired</button>
                                    <button class="time-btn" data-mood="restless">Restless</button>
                                </div>
                            </div>
                            <!-- END NEW -->

                            <!-- 3. Sound Override Selector -->
                            <div class="sound-selector" style="margin-top: var(--space-6);">
                                <h4>Background Sound (Override)</h4>
                                <!-- MODIFIED: Added ID for script.js to find this container -->
                                <div class="sound-options" id="soundOptionsButtons">
                                    <button class="sound-btn" data-sound="rain">
                                        <i class="fas fa-cloud-rain"></i>
                                        <span>Rain</span>
                                    </button>
                                    <button class="sound-btn" data-sound="ocean">
                                        <i class="fas fa-water"></i>
                                        <span>Ocean</span>
                                    </button>
                                    <button class="sound-btn" data-sound="forest">
                                        <i class="fas fa-tree"></i>
                                        <span>Forest</span>
                                    </button>
                                    <button class="sound-btn" data-sound="stream">
                                        <i class="fas fa-stream"></i>
                                        <span>Stream</span>
                                    </button>
                                    <button class="sound-btn" data-sound="silence">
                                        <i class="fas fa-volume-mute"></i>
                                        <span>Silence</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="meditation-types">
                        <h3>Meditation Types</h3>
                        <!-- MODIFIED: Added ID for script.js to find this container -->
                        <div class="type-list" id="meditationTypeSelector">
                            <div class="type-item active" data-meditation="breathing">
                                <i class="fas fa-wind"></i>
                                <div>
                                    <h4>Mindful Breathing</h4>
                                    <p>Focus on breath awareness</p>
                                </div>
                            </div>
                            <div class="type-item" data-meditation="body-scan">
                                <i class="fas fa-body"></i>
                                <div>
                                    <h4>Body Scan</h4>
                                    <p>Progressive relaxation technique</p>
                                </div>
                            </div>
                            <div class="type-item" data-meditation="loving-kindness">
                                <i class="fas fa-heart"></i>
                                <div>
                                    <h4>Loving Kindness</h4>
                                    <p>Cultivate compassion and love</p>
                                </div>
                            </div>
                            <div class="type-item" data-meditation="anxiety-relief">
                                <i class="fas fa-leaf"></i>
                                <div>
                                    <h4>Anxiety Relief</h4>
                                    <p>Calm your worried mind</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mood Tracking Section -->
        <section id="mood" class="section">
            <div class="container">
                <h2>Mood Tracker</h2>
                <div class="mood-grid">
                    <div class="mood-input-card">
                        <h3>How are you feeling today?</h3>
                        <div class="mood-selector">
                            <div class="mood-option" data-mood="5">
                                <i class="fas fa-grin-stars"></i>
                                <span>Super</span>
                            </div>
                            <div class="mood-option" data-mood="4">
                                <i class="fas fa-smile"></i>
                                <span>Good</span>
                            </div>
                            <div class="mood-option" data-mood="3">
                                <i class="fas fa-meh"></i>
                                <span>Okay</span>
                            </div>
                            <div class="mood-option" data-mood="2">
                                <i class="fas fa-frown"></i>
                                <span>Low</span>
                            </div>
                            <div class="mood-option" data-mood="1">
                                <i class="fas fa-sad-tear"></i>
                                <span>Struggle</span>
                            </div>
                        </div>

                        <div class="mood-notes">
                            <textarea id="moodNote" placeholder="Add a note about your mood (optional)..."></textarea>
                            <button class="btn btn-primary" id="saveMood">Save Mood</button>
                        </div>
                    </div>

                    <div class="mood-chart-card">
                        <h3>Your Mood Journey</h3>
                        <div class="chart-container" id="moodChartContainer">
                            <canvas id="moodChart" width="500" height="200"></canvas>
                        </div>
                        <div class="mood-stats">
                            <div class="stat">
                                <span class="stat-number" id="averageMood">--</span>
                                <span class="stat-label">Average This Week</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number" id="entriesCount">0</span>
                                <span class="stat-label">Entries Logged</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mood-history">
                    <h3>Recent Entries</h3>
                    <div class="mood-entries" id="moodEntries">
                        <!-- Mood entries will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Resources Section -->
        <section id="resources" class="section">
            <div class="container">
                <h2>Mental Health Resources</h2>
                <div class="resources-grid">
                    <div class="resource-category">
                        <h3>Educational Resources</h3>
                        <div class="resource-list">
                            <div class="resource-item">
                                <i class="fas fa-book"></i>
                                <div>
                                    <h4>Understanding Depression</h4>
                                    <p>Learn about symptoms, causes, and treatment options</p>
                                    <a href="https://www.nimh.nih.gov/health/topics/depression/index.shtml" class="resource-link" target="_blank">Read More</a>
                                </div>
                            </div>
                            <div class="resource-item">
                                <i class="fas fa-brain"></i>
                                <div>
                                    <h4>Anxiety Management</h4>
                                    <p>Techniques and strategies for managing anxiety</p>
                                    <a href="https://www.helpguide.org/articles/anxiety/anxiety-attack-symptoms-and-self-help.htm" class="resource-link" target="_blank">Read More</a>
                                </div>
                            </div>
                            <div class="resource-item">
                                <i class="fas fa-heart"></i>
                                <div>
                                    <h4>Self-Care Guide</h4>
                                    <p>Daily practices for mental wellness</p>
                                    <a href="https://www.psychologytoday.com/us/basics/self-care" class="resource-link" target="_blank">Read More</a>
                                </div>
                            </div>
                             <div class="resource-item">
                                <i class="fas fa-bed"></i>
                                <div>
                                    <h4>Improve Sleep Hygiene</h4>
                                    <p>Tips for getting better quality sleep</p>
                                    <a href="https://www.sleepfoundation.org/sleep-hygiene" class="resource-link" target="_blank">Read More</a>
                                </div>
                            </div>
                            <div class="resource-item">
                                <i class="fas fa-leaf"></i>
                                <div>
                                    <h4>Mindful Eating Basics</h4>
                                    <p>Practice awareness during meals</p>
                                    <a href="https://www.mindful.org/mindful-eating-start-here/" class="resource-link" target="_blank">Read More</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="resource-category">
                        <h3>Professional Help</h3>
                        <div class="resource-list">
                            <div class="resource-item">
                                <i class="fas fa-user-md"></i>
                                <div>
                                    <h4>Find a Therapist</h4>
                                    <p>Directory of mental health professionals</p>
                                    <a href="https://www.psychologytoday.com" class="resource-link" target="_blank">Visit Site</a>
                                </div>
                            </div>
                            <div class="resource-item">
                                <i class="fas fa-video"></i>
                                <div>
                                    <h4>Online Therapy</h4>
                                    <p>Convenient therapy sessions from home</p>
                                    <a href="https://www.betterhelp.com" class="resource-link" target="_blank">Learn More</a>
                                </div>
                            </div>
                            <div class="resource-item">
                                <i class="fas fa-users"></i>
                                <div>
                                    <h4>Support Groups</h4>
                                    <p>Connect with others who understand</p>
                                    <a href="httpsa://www.nami.org" class="resource-link" target="_blank">Find Groups</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="resource-category">
                        <h3>Helplines & Support (Tamil Nadu)</h3>
                        <div class="helpline-list">
                            <div class="helpline-item">
                                <div class="helpline-info">
                                    <h4>Tamil Nadu MANAS Helpline (24/7)</h4>
                                    <p>Mental health support for residents of Tamil Nadu</p>
                                </div>
                                <div class="helpline-contact">
                                    <span class="phone">104</span>
                                    <button class="btn btn-accent" onclick="window.location.href='tel:104'">Call Now</button>
                                </div>
                            </div>
                            <div class="helpline-item">
                                <div class="helpline-info">
                                    <h4>KIRAN National Mental Health Helpline</h4>
                                    <p>Free, 24/7 mental health and counseling support (All India)</p>
                                </div>
                                <div class="helpline-contact">
                                    <span class="phone">1800-599-0019</span>
                                    <button class="btn btn-accent" onclick="window.location.href='tel:18005990019'">Call Now</button>
                                </div>
                            </div>
                            <div class="helpline-item">
                                <div class="helpline-info">
                                    <h4>SNEHA Suicide Prevention (Chennai)</h4>
                                    <p>Confidential suicide prevention service</p>
                                </div>
                                <div class="helpline-contact">
                                    <span class="number">044-24640050</span>
                                    <button class="btn btn-accent" onclick="window.location.href='tel:04424640050'">Call Now</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Crisis Support Section -->
        <section id="crisis" class="section">
            <div class="container">
                <div class="crisis-header">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h2>Crisis Support</h2>
                    <p>If you're in immediate danger or having thoughts of self-harm, please reach out for help right away.</p>
                </div>

                <div class="crisis-grid">
                    <div class="emergency-card">
                        <h3>Immediate Emergency</h3>
                        <p>If you need police or an ambulance in India:</p>
                        <button class="btn btn-emergency" onclick="window.location.href='tel:100'">
                            <i class="fas fa-phone"></i>
                            Call 100/108
                        </button>
                    </div>

                    <div class="crisis-hotlines">
                        <h3>Crisis Hotlines (India)</h3>
                        <div class="hotline-grid">
                            <div class="hotline-card">
                                <h4>Tamil Nadu MANAS Helpline</h4>
                                <p>24/7 mental health support</p>
                                <div class="hotline-contact">
                                    <span class="number">104</span>
                                    <button class="btn btn-crisis" onclick="window.location.href='tel:104'">Call</button>
                                </div>
                            </div>
                            <div class="hotline-card">
                                <h4>KIRAN Helpline</h4>
                                <p>All-India Free Mental Health Helpline</p>
                                <div class="hotline-contact">
                                    <span class="number">1800-599-0019</span>
                                    <button class="btn btn-crisis" onclick="window.location.href='tel:18005990019'">Call</button>
                                </div>
                            </div>
                            <div class="hotline-card">
                                <h4>Emergency Services</h4>
                                <p>General Emergency Number (Police/Ambulance)</p>
                                <div class="hotline-contact">
                                    <span class="number">112</span>
                                    <button class="btn btn-crisis" onclick="window.location.href='tel:112'">Call</button>
                                </div>
                            </div>
                            <div class="hotline-card">
                                <h4>Suicide Prevention (Sneha)</h4>
                                <p>Chennai-based confidential support</p>
                                <div class="hotline-contact">
                                    <span class="number">044-24640050</span>
                                    <button class="btn btn-crisis" onclick="window.location.href='tel:04424640050'">Call</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="safety-plan">
                        <h3>Personal Safety Plan</h3>
                        <div class="safety-steps">
                            <div class="safety-step">
                                <span class="step-number">1</span>
                                <div>
                                    <h4>Recognize Warning Signs</h4>
                                    <textarea placeholder="List your personal warning signs..." rows="4"></textarea>
                                </div>
                            </div>
                            <div class="safety-step">
                                <span class="step-number">2</span>
                                <div>
                                    <h4>Coping Strategies</h4>
                                    <textarea placeholder="What helps you feel better?..." rows="4"></textarea>
                                </div>
                            </div>
                            <div class="safety-step">
                                <span class="step-number">3</span>
                                <div>
                                    <h4>Support Contacts</h4>
                                    <textarea placeholder="List trusted friends, family, or professionals..." rows="4"></textarea>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary" id="saveSafetyPlan">Save Safety Plan</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Chat Support Section -->
        <section id="chat" class="section">
            <div class="container">
                <h2>Wellness Chat Support</h2>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class-"message bot-message">
                            <div class="message-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-content">
                                <p>Hello! I'm your wellness assistant. I'm here to provide emotional support and guidance. How are you feeling today?</p>
                                <span class="message-time">Now</span>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input">
                            <textarea id="chatInput" placeholder="Type your message here..." rows="2"></textarea>
                            <button class="send-btn" id="sendMessage">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="chat-disclaimer">
                            <p><i class="fas fa-info-circle"></i> This is an AI assistant for wellness support. For emergencies, please call the local helpline (104) or emergency services (112).</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- REMOVED: Logout Confirmation Modal HTML -->

    <!-- App Logic MUST be loaded first -->
    <script src="script.js"></script> 
    <!-- Auth Module MUST be loaded after script.js, as it depends on window.app -->
    <script type="module" src="auth.js"></script> 

    <!-- NEW SCRIPT for direct logout -->
    <script>
        // This function performs the logout and redirects immediately.
        function handleDirectLogout() {
            console.log('Logout clicked. Proceeding with logout and redirect...');

            // Check if the original logout function exists (from auth.js)
            if (typeof window.logout === 'function') {
                try {
                    // Call the original logout function
                    const result = window.logout();
                    
                    // Check if it returned a promise (common for auth operations)
                    if (result && typeof result.then === 'function') {
                        // It's a promise, wait for it to resolve before redirecting
                        result.then(() => {
                            console.log('Async logout complete. Redirecting to Homepage.html...');
                            window.location.href = 'Homepage.html';
                        }).catch(error => {
                            console.error('Error during async logout:', error);
                            // Still redirect even if logout had an error
                            window.location.href = 'Homepage.html';
                        });
                    } else {
                        // It's not a promise, just redirect immediately
                        console.log('Sync logout complete. Redirecting to Homepage.html...');
                        window.location.href = 'Homepage.html';
                    }
                } catch (error) {
                    console.error('Error calling logout function:', error);
                    // Redirect anyway
                    window.location.href = 'Homepage.html';
                }
            } else {
                // Fallback if window.logout isn't defined for some reason
                console.warn('window.logout not found. Redirecting directly to Homepage.html.');
                window.location.href = 'Homepage.html';
            }
        }
    </script>
</body>
</html>